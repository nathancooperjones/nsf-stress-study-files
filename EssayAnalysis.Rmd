---
title: "Essay Analysis across Groups" 
output: pdf_document 
geometry: "top=3.5cm, bottom=3cm" 
header-includes: 
- \usepackage{booktabs} 
- \usepackage{sectsty} \sectionfont{\centering} 
- \usepackage{bbm} 
- \usepackage{algorithm} 
- \usepackage[noend]{algpseudocode} 
--- 

```{r echo=FALSE, warning = FALSE, message = FALSE, results = "asis"} 

library(tidyverse) 
library(grid) 
library(gridExtra) 
library(scales) 
library(knitr) 
library(ggpubr) 
extrafont::loadfonts(quiet=TRUE) 

# function for annotating boxplot with n 
give.n <- function(x) { 
  return(c(y=-Inf, vjust = -1, label=length(x))) 
} 

print_output <- function(output, cex = 0.7) { 
  tmp <- capture.output(output) 
  plot.new() 
  text(0, 1, paste(tmp, collapse='\n'), adj = c(0,1), family = 'mono', cex = cex) 
} 

essay_df <- read_csv("~/Desktop/essay_nlp_results.csv", col_types = cols()) 

wb_essay_df <- essay_df %>% 
  filter(Essay == "WB") 

wb_essay_df %>% 
  ggplot(aes(x = Condition, y = WordCount)) + 
    geom_boxplot() + 
    theme_bw() + 
    theme(axis.title.x=element_blank(), axis.text.x = element_text(size=10)) + 
    labs(title = paste0("WB Word Count Across Groups"), 
         y = "Word Count") + 
    stat_summary(fun.y = mean, color = "darkred", geom = "point", 
                 shape = 3, size = 2) + 
    stat_summary(fun.data = give.n, geom = "text") + 
    scale_y_continuous(expand = c(0.1, 0, 0.1, 0)) 
  
cat("ANOVA:  \n  ") 
anova_test <- aov(WordCount ~ Condition, data = wb_essay_df) 
print_output(summary(anova_test)) 
cat("  \n---  \n\n  ") 
print_output(TukeyHSD(anova_test)) 
cat("  \n  ") 

wb_essay_df %>% 
  ggplot(aes(x = Condition, y = SentenceCount)) + 
    geom_boxplot() + 
    theme_bw() + 
    theme(axis.title.x=element_blank(), axis.text.x = element_text(size=10)) + 
    labs(title = paste0("WB Sentence Count Across Groups"), 
         y = "Sentence Count") + 
    stat_summary(fun.y = mean, color = "darkred", geom = "point", 
                 shape = 3, size = 2) + 
    stat_summary(fun.data = give.n, geom = "text") + 
    scale_y_continuous(expand = c(0.1, 0, 0.1, 0)) 
  
cat("ANOVA:  \n  ") 
anova_test <- aov(SentenceCount ~ Condition, data = wb_essay_df) 
print_output(summary(anova_test)) 
cat("  \n---  \n\n  ") 
print_output(TukeyHSD(anova_test)) 
cat("  \n  ") 

dt_essay_df <- essay_df %>% 
  filter(Essay == "DT") 

dt_essay_df %>% 
  ggplot(aes(x = Condition, y = WordCount)) + 
    geom_boxplot() + 
    theme_bw() + 
    theme(axis.title.x=element_blank(), axis.text.x = element_text(size=10)) + 
    labs(title = paste0("DT Word Count Across Groups"), 
         y = "Word Count") + 
    stat_summary(fun.y = mean, color = "darkred", geom = "point", 
                 shape = 3, size = 2) + 
    stat_summary(fun.data = give.n, geom = "text") + 
    scale_y_continuous(expand = c(0.1, 0, 0.1, 0)) 
  
cat("ANOVA:  \n  ") 
anova_test <- aov(WordCount ~ Condition, data = dt_essay_df) 
print_output(summary(anova_test)) 
cat("  \n---  \n\n  ") 
print_output(TukeyHSD(anova_test)) 
cat("  \n  ") 

dt_essay_df %>% 
  ggplot(aes(x = Condition, y = SentenceCount)) + 
    geom_boxplot() + 
    theme_bw() + 
    theme(axis.title.x=element_blank(), axis.text.x = element_text(size=10)) + 
    labs(title = paste0("DT Sentence Count Across Groups"), 
         y = "Sentence Count") + 
    stat_summary(fun.y = mean, color = "darkred", geom = "point", 
                 shape = 3, size = 2) + 
    stat_summary(fun.data = give.n, geom = "text") + 
    scale_y_continuous(expand = c(0.1, 0, 0.1, 0)) 
  
cat("ANOVA:  \n  ") 
anova_test <- aov(SentenceCount ~ Condition, data = dt_essay_df) 
print_output(summary(anova_test)) 
cat("  \n---  \n\n  ") 
print_output(TukeyHSD(anova_test)) 
cat("  \n  ") 

``` 
